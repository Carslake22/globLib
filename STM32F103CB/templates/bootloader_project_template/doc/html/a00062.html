<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Project: RTC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00062.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">RTC<div class="ingroups"><a class="el" href="a00052.html">STM32F103CB</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains functions for working with the real time clock.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for RTC:</div>
<div class="dyncontent">
<center><table><tr><td><img src="a00062.png" border="0" alt="" usemap="#a00062"/>
<map name="a00062" id="a00062">
<area shape="rect" id="node2" href="a00052.html" title="STM32F103CB" alt="" coords="5,5,117,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:a00037"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00037.html">stm32f103cb_rtc.h</a></td></tr>
<tr class="memdesc:a00037"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header file for stm32f103cb real time clock (RTC) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae57375dd50be117c52297d4206a02a70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gae57375dd50be117c52297d4206a02a70">RTC_setup</a> (uint32_t resolution)</td></tr>
<tr class="memdesc:gae57375dd50be117c52297d4206a02a70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the Real time clock.  <a href="#gae57375dd50be117c52297d4206a02a70">More...</a><br /></td></tr>
<tr class="separator:gae57375dd50be117c52297d4206a02a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29e80054eac721108b89d2ffcd0281a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga29e80054eac721108b89d2ffcd0281a7">RTC_calibrate</a> (uint32_t resolution)</td></tr>
<tr class="memdesc:ga29e80054eac721108b89d2ffcd0281a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrate the RTC to a given resolution in milliseconds.  <a href="#ga29e80054eac721108b89d2ffcd0281a7">More...</a><br /></td></tr>
<tr class="separator:ga29e80054eac721108b89d2ffcd0281a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b74feb0d01a5943a6928824d71f5a6d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga0b74feb0d01a5943a6928824d71f5a6d">RTC_setPrescaler</a> (uint32_t resolution)</td></tr>
<tr class="memdesc:ga0b74feb0d01a5943a6928824d71f5a6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the raw prescaler value of the RTC.  <a href="#ga0b74feb0d01a5943a6928824d71f5a6d">More...</a><br /></td></tr>
<tr class="separator:ga0b74feb0d01a5943a6928824d71f5a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e634b272e7cca85d804bfc273629170"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga4e634b272e7cca85d804bfc273629170">RTC_isAlarmEnabled</a> (void)</td></tr>
<tr class="memdesc:ga4e634b272e7cca85d804bfc273629170"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the alarm interrupt is enabled.  <a href="#ga4e634b272e7cca85d804bfc273629170">More...</a><br /></td></tr>
<tr class="separator:ga4e634b272e7cca85d804bfc273629170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f132f88293253b6065d80618415ef64"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga2f132f88293253b6065d80618415ef64">RTC_isOverflowEnabled</a> (void)</td></tr>
<tr class="memdesc:ga2f132f88293253b6065d80618415ef64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the overflow interrupt is enabled.  <a href="#ga2f132f88293253b6065d80618415ef64">More...</a><br /></td></tr>
<tr class="separator:ga2f132f88293253b6065d80618415ef64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d530d8daabf10196d2ead323c1adc04"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga4d530d8daabf10196d2ead323c1adc04">RTC_isResolutionEnabled</a> (void)</td></tr>
<tr class="memdesc:ga4d530d8daabf10196d2ead323c1adc04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the resolution (second) interrupt is enabled.  <a href="#ga4d530d8daabf10196d2ead323c1adc04">More...</a><br /></td></tr>
<tr class="separator:ga4d530d8daabf10196d2ead323c1adc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab02af75654cc95da39769764d48c0328"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gab02af75654cc95da39769764d48c0328">RTC_getCount</a> (void)</td></tr>
<tr class="memdesc:gab02af75654cc95da39769764d48c0328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current count value.  <a href="#gab02af75654cc95da39769764d48c0328">More...</a><br /></td></tr>
<tr class="separator:gab02af75654cc95da39769764d48c0328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3bca791836b0b78ef8e9e92954644480"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga3bca791836b0b78ef8e9e92954644480">RTC_setCount</a> (uint32_t count)</td></tr>
<tr class="memdesc:ga3bca791836b0b78ef8e9e92954644480"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current count value.  <a href="#ga3bca791836b0b78ef8e9e92954644480">More...</a><br /></td></tr>
<tr class="separator:ga3bca791836b0b78ef8e9e92954644480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6c3797b32379e7f82ea3c4c40a001df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gac6c3797b32379e7f82ea3c4c40a001df">RTC_enableResolutionISR</a> (void(*res_isr)(void))</td></tr>
<tr class="memdesc:gac6c3797b32379e7f82ea3c4c40a001df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the resolution ISR.  <a href="#gac6c3797b32379e7f82ea3c4c40a001df">More...</a><br /></td></tr>
<tr class="separator:gac6c3797b32379e7f82ea3c4c40a001df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7990d735a7d99cf8db3b124679d14482"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga7990d735a7d99cf8db3b124679d14482">RTC_enableAlarmISR</a> (uint32_t count, void(*al_isr)(void))</td></tr>
<tr class="memdesc:ga7990d735a7d99cf8db3b124679d14482"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the alarm ISR.  <a href="#ga7990d735a7d99cf8db3b124679d14482">More...</a><br /></td></tr>
<tr class="separator:ga7990d735a7d99cf8db3b124679d14482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf30b357b36ff96641f416e850e83ec91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gaf30b357b36ff96641f416e850e83ec91">RTC_enableOverflowISR</a> (void(*ov_isr)(void))</td></tr>
<tr class="memdesc:gaf30b357b36ff96641f416e850e83ec91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the overflow ISR.  <a href="#gaf30b357b36ff96641f416e850e83ec91">More...</a><br /></td></tr>
<tr class="separator:gaf30b357b36ff96641f416e850e83ec91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacddd6d7630f932ca710f297a1001b1c6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gacddd6d7630f932ca710f297a1001b1c6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gacddd6d7630f932ca710f297a1001b1c6">RTC_disableResolutionISR</a> (void)</td></tr>
<tr class="memdesc:gacddd6d7630f932ca710f297a1001b1c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">disables the resolution ISR. <br /></td></tr>
<tr class="separator:gacddd6d7630f932ca710f297a1001b1c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbd4815a85c2a4b501764faff14630a8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabbd4815a85c2a4b501764faff14630a8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gabbd4815a85c2a4b501764faff14630a8">RTC_disableAlarmISR</a> (void)</td></tr>
<tr class="memdesc:gabbd4815a85c2a4b501764faff14630a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">disables the alarm ISR. <br /></td></tr>
<tr class="separator:gabbd4815a85c2a4b501764faff14630a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f5c5ddebe1514284a8d010491fdeef1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5f5c5ddebe1514284a8d010491fdeef1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#ga5f5c5ddebe1514284a8d010491fdeef1">RTC_disableOverflowISR</a> (void)</td></tr>
<tr class="memdesc:ga5f5c5ddebe1514284a8d010491fdeef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">disables the overflow ISR. <br /></td></tr>
<tr class="separator:ga5f5c5ddebe1514284a8d010491fdeef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab407ae2b3e303d16092fb89b1735e1a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00062.html#gab407ae2b3e303d16092fb89b1735e1a8">RTC_clockEnable</a> (void)</td></tr>
<tr class="memdesc:gab407ae2b3e303d16092fb89b1735e1a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable the RTC clock.  <a href="#gab407ae2b3e303d16092fb89b1735e1a8">More...</a><br /></td></tr>
<tr class="separator:gab407ae2b3e303d16092fb89b1735e1a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module contains functions for working with the real time clock. </p>
<p>The real time clock works with the internal LSI oscillator, this runs at approximately 40kHz. This clock functions seperate from the main clock and can be used in standby mode to wake the core from sleep state. This is acheived by setting the alarm to the desired wakeup time.</p>
<p>Both the counter and alarm registers are 32 bits wide, for a 1 second tick this is approximately 136 years before an overflow event occurs! At 1ms it is 7 weeks. The prescaler is 20 bits wide, giving a meer 3600 years as a maximum value.</p>
<p>The accuracy of the RTC increases with increasing resolution approximated as</p><ul>
<li>1ms tick (minimum) ~0.5ms accuracy</li>
<li>10ms tick ~0.05ms accuracy</li>
<li>100ms tick ~0.005ms accuracy</li>
</ul>
<p>and so on. These values assume <a class="el" href="a00062.html#ga29e80054eac721108b89d2ffcd0281a7" title="Calibrate the RTC to a given resolution in milliseconds. ">RTC_calibrate()</a> was used to determine the preload value.</p>
<p>There are three interrupts which can be generated with the RTC</p><ul>
<li>resolution, occuring with the value set (ms) in <a class="el" href="a00062.html#ga29e80054eac721108b89d2ffcd0281a7" title="Calibrate the RTC to a given resolution in milliseconds. ">RTC_calibrate()</a> or <a class="el" href="a00062.html#gae57375dd50be117c52297d4206a02a70" title="Initialize the Real time clock. ">RTC_setup()</a></li>
<li>alarm, occuring when the counter value reaches a set value. This is also used to wake the core from standby mode.</li>
<li>overflow, occurs when the counter overflows.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Stuart Ianna </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 2018 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU GPLv3 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="a00001.html#_bug000020">Bug:</a></b></dt><dd>None </dd></dl>
<dl class="todo"><dt><b><a class="el" href="a00002.html#_todo000010">Todo:</a></b></dt><dd></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>RTC_configure() requires a one-shot usage of systick. This means that this function should be called before any other systick usage.</dd></dl>
<dl class="section user"><dt>Compilers</dt><dd><ul>
<li>arm-none-eabi-gcc (15:4.9.3+svn231177-1) 4.9.3 20150529 (prerelease)</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Working example. </dt><dd><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00023.html">stm32f103cb_core.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> alarm(<span class="keywordtype">void</span>);</div><div class="line"><span class="keywordtype">void</span> resolution(<span class="keywordtype">void</span>);</div><div class="line"><span class="keywordtype">void</span> overflow(<span class="keywordtype">void</span>);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>){</div><div class="line"></div><div class="line">    <span class="comment">//Coms for terminal info</span></div><div class="line">    <a class="code" href="a00055.html#ga91e8b31d85381acb276e810ae679556c">USB_coms</a>(<a class="code" href="a00065.html#gga90028e095f2a7a5490b5e10109bb18c4a86f5987be452599d06a5d8f47a454d2b">TIMER_2</a>);</div><div class="line"></div><div class="line">    <span class="comment">//The value passed here is meaningless as RTC_calibrate is called next.</span></div><div class="line">    <a class="code" href="a00062.html#gae57375dd50be117c52297d4206a02a70">RTC_setup</a>(500);</div><div class="line"></div><div class="line">    <span class="comment">//This uses systick!</span></div><div class="line">    <span class="comment">//This takes 500ms to complete! </span></div><div class="line">    <span class="comment">//(smaller resolution, shorter time, less accurate)</span></div><div class="line">    <a class="code" href="a00062.html#ga29e80054eac721108b89d2ffcd0281a7">RTC_calibrate</a>(500);</div><div class="line">    <span class="comment">//Systick could be used here again if needed</span></div><div class="line">   </div><div class="line">    <span class="comment">//Good to reset the count after so everything starts at 0</span></div><div class="line">    <a class="code" href="a00062.html#ga3bca791836b0b78ef8e9e92954644480">RTC_setCount</a>(0);</div><div class="line"></div><div class="line">    <span class="comment">//Call alarm after 2 resultion counts (1 second)</span></div><div class="line">    <a class="code" href="a00062.html#ga7990d735a7d99cf8db3b124679d14482">RTC_enableAlarmISR</a>(2,&amp;alarm);</div><div class="line"></div><div class="line">    <span class="comment">//Call resolution every period. (500ms)</span></div><div class="line">    <a class="code" href="a00062.html#gac6c3797b32379e7f82ea3c4c40a001df">RTC_enableResolutionISR</a>(&amp;resolution);</div><div class="line"></div><div class="line">    <span class="comment">//Call this after a couple of years.</span></div><div class="line">    <a class="code" href="a00062.html#gaf30b357b36ff96641f416e850e83ec91">RTC_enableOverflowISR</a>(&amp;overflow);</div><div class="line"></div><div class="line">    <span class="comment">//Done</span></div><div class="line">    <span class="keywordflow">while</span>(1);</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> alarm(<span class="keywordtype">void</span>){</div><div class="line"></div><div class="line">    <a class="code" href="a00073.html#ga327fc45db81e4959673d04975a4d49d4">printl</a>(<span class="stringliteral">&quot;Alarm&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//The clock continues to count.</span></div><div class="line">    <span class="comment">//Set the alarm again after 2 counts (1 second)</span></div><div class="line">    <a class="code" href="a00062.html#ga7990d735a7d99cf8db3b124679d14482">RTC_enableAlarmISR</a>(<a class="code" href="a00062.html#gab02af75654cc95da39769764d48c0328">RTC_getCount</a>() + 2,&amp;alarm);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> resolution(<span class="keywordtype">void</span>){</div><div class="line"></div><div class="line">    <a class="code" href="a00073.html#ga327fc45db81e4959673d04975a4d49d4">printl</a>(<span class="stringliteral">&quot;Resolution&quot;</span>);</div><div class="line">} </div><div class="line"></div><div class="line"><span class="keywordtype">void</span> overflow(<span class="keywordtype">void</span>){</div><div class="line"></div><div class="line">    <a class="code" href="a00073.html#ga327fc45db81e4959673d04975a4d49d4">printl</a>(<span class="stringliteral">&quot;Overflow&quot;</span>);</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga29e80054eac721108b89d2ffcd0281a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a> RTC_calibrate </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrate the RTC to a given resolution in milliseconds. </p>
<p>This function uses SYSTICK to calculate the required RTC prescaler. SYSTICK must not be used for any other function while this is being called. After complete SYSTICK can be utalised again.</p>
<p>This function will take as long as the resultion to complete!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resolution</td><td>The required resolution of the RTC in milliseconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Read description. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Error number as defined in <a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c" title="Error enumerators for the Debug peripheral. ">mcu_error</a>, E_RTC_NOERROR if ok or E_RTC_PRESCALER if an error with prescaler value has occured. </dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00064">64</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_ga29e80054eac721108b89d2ffcd0281a7_cgraph.png" border="0" usemap="#a00062_ga29e80054eac721108b89d2ffcd0281a7_cgraph" alt=""/></div>
<map name="a00062_ga29e80054eac721108b89d2ffcd0281a7_cgraph" id="a00062_ga29e80054eac721108b89d2ffcd0281a7_cgraph">
<area shape="rect" id="node2" href="a00056.html#ga614572dee15ef0779db99ea82eeb0eba" title="Checks if debug is enabled. " alt="" coords="505,5,659,32"/>
<area shape="rect" id="node3" href="a00056.html#ga81ef53ef853b20441647e4f7b205e05f" title="Print a given error number as a character stream. " alt="" coords="525,132,639,159"/>
<area shape="rect" id="node4" href="a00064.html#gaafba91666a34a65bf0e02d20a85aca0a" title="Sets up systick and handler. " alt="" coords="160,107,279,133"/>
<area shape="rect" id="node8" href="a00064.html#gadad1ddea7c5acc826d176dcc1ba56b9a" title="Stop the systick counter. " alt="" coords="163,208,275,235"/>
<area shape="rect" id="node5" href="a00064.html#gaeb70e913a1bdeb326bf2dc0f7b585a4e" title="Change the systick timeout value. " alt="" coords="327,56,457,83"/>
<area shape="rect" id="node7" href="a00064.html#gaf21e939cb177a8c7482890976e334573" title="Sets the handler called on interrupt event. " alt="" coords="327,107,457,133"/>
<area shape="rect" id="node6" href="a00054.html#ga3199fc3077a8e5f69aaaea0e45c28927" title="Get the current clock speed of the device. " alt="" coords="517,56,647,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab407ae2b3e303d16092fb89b1735e1a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RTC_clockEnable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable the RTC clock. </p>
<p>This can be used to renable the clock after system has been in stop mode. </p>

<p>Definition at line <a class="el" href="a00036_source.html#l00096">96</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7990d735a7d99cf8db3b124679d14482"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RTC_enableAlarmISR </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>al_isr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables the alarm ISR. </p>
<p>This interrupt occurs when the counter value matches the alarm value. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">count</td><td>The value at which the count register triggers the interrupt. </td></tr>
    <tr><td class="paramname">al_isr</td><td>The function to call on interrupt. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00133">133</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_ga7990d735a7d99cf8db3b124679d14482_cgraph.png" border="0" usemap="#a00062_ga7990d735a7d99cf8db3b124679d14482_cgraph" alt=""/></div>
<map name="a00062_ga7990d735a7d99cf8db3b124679d14482_cgraph" id="a00062_ga7990d735a7d99cf8db3b124679d14482_cgraph">
<area shape="rect" id="node2" href="a00062.html#gabbd4815a85c2a4b501764faff14630a8" title="disables the alarm ISR. " alt="" coords="205,5,360,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf30b357b36ff96641f416e850e83ec91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RTC_enableOverflowISR </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>ov_isr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables the overflow ISR. </p>
<p>This interrupt occurs when the counter register overflows (never) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ov_isr</td><td>The function to call on interrupt. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00155">155</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_gaf30b357b36ff96641f416e850e83ec91_cgraph.png" border="0" usemap="#a00062_gaf30b357b36ff96641f416e850e83ec91_cgraph" alt=""/></div>
<map name="a00062_gaf30b357b36ff96641f416e850e83ec91_cgraph" id="a00062_gaf30b357b36ff96641f416e850e83ec91_cgraph">
<area shape="rect" id="node2" href="a00062.html#ga5f5c5ddebe1514284a8d010491fdeef1" title="disables the overflow ISR. " alt="" coords="224,5,397,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac6c3797b32379e7f82ea3c4c40a001df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RTC_enableResolutionISR </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>res_isr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables the resolution ISR. </p>
<p>This interrupt occurs each resoultion time value. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res_isr</td><td>The function to call on interrupt. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00111">111</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_gac6c3797b32379e7f82ea3c4c40a001df_cgraph.png" border="0" usemap="#a00062_gac6c3797b32379e7f82ea3c4c40a001df_cgraph" alt=""/></div>
<map name="a00062_gac6c3797b32379e7f82ea3c4c40a001df_cgraph" id="a00062_gac6c3797b32379e7f82ea3c4c40a001df_cgraph">
<area shape="rect" id="node2" href="a00062.html#gacddd6d7630f932ca710f297a1001b1c6" title="disables the resolution ISR. " alt="" coords="233,5,416,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab02af75654cc95da39769764d48c0328"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t RTC_getCount </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current count value. </p>
<dl class="section return"><dt>Returns</dt><dd>The current value (Of units respect to resolution) </dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00101">101</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga4e634b272e7cca85d804bfc273629170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t RTC_isAlarmEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the alarm interrupt is enabled. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the alarm is disabled</li>
<li>Non-zero if the alarm is enabled </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00147">147</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2f132f88293253b6065d80618415ef64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t RTC_isOverflowEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the overflow interrupt is enabled. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the overflow is disabled</li>
<li>Non-zero if the overflow is enabled </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00168">168</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga4d530d8daabf10196d2ead323c1adc04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t RTC_isResolutionEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the resolution (second) interrupt is enabled. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the second is disabled</li>
<li>Non-zero if the second is enabled </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00124">124</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3bca791836b0b78ef8e9e92954644480"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RTC_setCount </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the current count value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">count</td><td>The current value to set the count to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00090">90</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga0b74feb0d01a5943a6928824d71f5a6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a> RTC_setPrescaler </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the raw prescaler value of the RTC. </p>
<p>This value determines the period of the count incrementation. Usage of RTC_calabrate() superseeds the need for this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resolution</td><td>The value written the the RTC prescaler register. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error number as defined in <a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c" title="Error enumerators for the Debug peripheral. ">mcu_error</a>, E_RTC_NOERROR if ok or E_RTC_PRESCALER if an error with prescaler value has occured. </dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00049">49</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_ga0b74feb0d01a5943a6928824d71f5a6d_cgraph.png" border="0" usemap="#a00062_ga0b74feb0d01a5943a6928824d71f5a6d_cgraph" alt=""/></div>
<map name="a00062_ga0b74feb0d01a5943a6928824d71f5a6d_cgraph" id="a00062_ga0b74feb0d01a5943a6928824d71f5a6d_cgraph">
<area shape="rect" id="node2" href="a00056.html#ga614572dee15ef0779db99ea82eeb0eba" title="Checks if debug is enabled. " alt="" coords="184,5,337,32"/>
<area shape="rect" id="node3" href="a00056.html#ga81ef53ef853b20441647e4f7b205e05f" title="Print a given error number as a character stream. " alt="" coords="204,56,317,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae57375dd50be117c52297d4206a02a70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c">mcu_error</a> RTC_setup </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Real time clock. </p>
<p>This must be called before any other feature is used.</p>
<p>The resolution here is loaded directly to the prescalar register. The final period of the clock can be estimated using </p><pre class="fragment">period (ms) = (resolution/4)
</pre><p>This doesn't produce a very accurate result, and if possible RTC_calibrate should be called following this funcition. This automatically sets the period to the desired value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resolution</td><td>The value written to the prescaler register </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error number as defined in <a class="el" href="a00056.html#ga90d6d08ec193c9751b20ce1d143b7f3c" title="Error enumerators for the Debug peripheral. ">mcu_error</a>, E_RTC_NOERROR if ok or E_RTC_PRESCALER if an error with prescaler value has occured. </dd></dl>

<p>Definition at line <a class="el" href="a00036_source.html#l00033">33</a> of file <a class="el" href="a00036_source.html">stm32f103cb_rtc.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00062_gae57375dd50be117c52297d4206a02a70_cgraph.png" border="0" usemap="#a00062_gae57375dd50be117c52297d4206a02a70_cgraph" alt=""/></div>
<map name="a00062_gae57375dd50be117c52297d4206a02a70_cgraph" id="a00062_gae57375dd50be117c52297d4206a02a70_cgraph">
<area shape="rect" id="node2" href="a00056.html#ga614572dee15ef0779db99ea82eeb0eba" title="Checks if debug is enabled. " alt="" coords="321,5,475,32"/>
<area shape="rect" id="node3" href="a00056.html#ga81ef53ef853b20441647e4f7b205e05f" title="Print a given error number as a character stream. " alt="" coords="341,81,455,108"/>
<area shape="rect" id="node4" href="a00062.html#gab407ae2b3e303d16092fb89b1735e1a8" title="Enable the RTC clock. " alt="" coords="144,81,272,108"/>
<area shape="rect" id="node5" href="a00062.html#ga0b74feb0d01a5943a6928824d71f5a6d" title="Set the raw prescaler value of the RTC. " alt="" coords="143,31,273,57"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 16 2018 18:26:54 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
